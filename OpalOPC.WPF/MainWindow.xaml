<Window
    x:Class="OpalOPC.WPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:OpalOPC.WPF"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:resources="clr-namespace:OpalOPC.WPF.Resources"
    xmlns:system="clr-namespace:System;assembly=System.Runtime"
    Title="{Binding Title}"
    Width="1280"
    Height="768"
    MinWidth="800"
    MinHeight="600"
    d:DataContext="{d:DesignInstance Type=local:MainWindowViewModel}"
    d:DesignHeight="800"
    d:DesignWidth="800"
    Background="{StaticResource White_Brush}"
    SnapsToDevicePixels="True"
    UseLayoutRounding="True"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">

    <Window.Resources>
        <resources:ScrollBarVisibilityConverter x:Key="ScrollBarVisibilityConverter" />
        <!--  Style for buttons to grey them out while disabled  -->
        <Style x:Key="GrayDisabledButton" TargetType="Button">
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value=".25" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Style.Triggers>
                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                    <Setter Property="Background" Value="{StaticResource ListItem_Background_Brush}" />
                </Trigger>
                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                    <Setter Property="Background" Value="Transparent" />
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style
            x:Key="EmptyListStyle"
            BasedOn="{StaticResource {x:Type ListBox}}"
            TargetType="ListBox">
            <Style.Triggers>
                <Trigger Property="HasItems" Value="False">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <TextBlock>No targets specified.</TextBlock>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>


        <Style x:Key="NavbarCustomButtonTemplateStyle" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource Dark_Grey_Brush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            BorderBrush="Black"
                            BorderThickness="0"
                            CornerRadius="10">
                            <ContentPresenter
                                x:Name="contentPresenter"
                                Margin="0,0,0,0"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                                <Setter Property="Foreground" Value="{StaticResource Dark_Blue_Brush}" />
                                <Setter Property="Cursor" Value="Hand" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="LightBlue" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <ControlTemplate x:Key="ImageButtonTemplate" TargetType="Button">
            <Border
                x:Name="border"
                Background="{TemplateBinding Background}"
                BorderBrush="Black"
                BorderThickness="0"
                CornerRadius="5">
                <ContentPresenter
                    Margin="0,0,0,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center" />
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                    <Setter Property="Cursor" Value="Hand" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="border" Property="Background" Value="LightBlue" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>


        <ControlTemplate x:Key="DragAndDropButtonTemplate" TargetType="Button">
            <Border
                x:Name="border"
                Background="{TemplateBinding Background}"
                BorderThickness="1,1,1,1"
                CornerRadius="10">
                <ContentPresenter
                    Margin="0,0,0,0"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center" />
                <Border.BorderBrush>
                    <DrawingBrush
                        TileMode="Tile"
                        Viewport="0,0,16,16"
                        ViewportUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <DrawingGroup>
                                <GeometryDrawing Brush="Black">
                                    <GeometryDrawing.Geometry>
                                        <GeometryGroup>
                                            <RectangleGeometry Rect="0,0,50,50" />
                                            <RectangleGeometry Rect="50,50,50,50" />
                                        </GeometryGroup>
                                    </GeometryDrawing.Geometry>
                                </GeometryDrawing>
                            </DrawingGroup>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Border.BorderBrush>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                    <Setter Property="Cursor" Value="Hand" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="border" Property="Background" Value="LightBlue" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>


    </Window.Resources>


    <Grid x:Name="TopLevelWindowGrid">
        <Grid.ColumnDefinitions>
            <!--  navigation bar left  -->
            <ColumnDefinition Width="*" />

            <!--  content area right  -->
            <ColumnDefinition Width="5*" />
        </Grid.ColumnDefinitions>

        <!--  navbar on left side  -->
        <Grid Grid.Row="0" Grid.Column="0">
            <StackPanel Background="{StaticResource NavBarBackground_Brush}" Orientation="Vertical">
                <StackPanel Margin="10,40,10,60" VerticalAlignment="Center">
                    <Image
                        Width="Auto"
                        Height="50"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        RenderOptions.BitmapScalingMode="HighQuality"
                        Source="/Assets/LogoImage.png"
                        Stretch="Uniform" />
                </StackPanel>

                <!--  Navbar buttons  -->
                <Button
                    Width="Auto"
                    Height="62"
                    Margin="10,0,10,10"
                    Padding="0"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Top"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Click="Navbar_About_Click"
                    Style="{StaticResource NavbarCustomButtonTemplateStyle}">
                    <StackPanel Orientation="Horizontal">
                        <Path
                            Width="24"
                            Height="24"
                            Data="F1 M 10 0 C 15.52299976348877 0 20 4.4770002365112305 20 10 C 20 15.52299976348877 15.52299976348877 20 10 20 C 4.4770002365112305 20 0 15.52299976348877 0 10 C 0 4.4770002365112305 4.4770002365112305 0 10 0 Z M 10 2 C 7.878268003463745 2.0000000000000018 5.84343683719635 2.842854857444763 4.343145847320557 4.343145847320557 C 2.842854857444763 5.84343683719635 2.0000000000000027 7.878268003463745 2 10 C 2.0000000000000018 12.121731996536255 2.842854857444763 14.156563639640808 4.343145847320557 15.656854629516602 C 5.84343683719635 17.157145619392395 7.878268003463745 17.999999999999996 10 18 C 12.121731996536255 17.999999999999996 14.156563639640808 17.157145619392395 15.656854629516602 15.656854629516602 C 17.157145619392395 14.156563639640808 17.999999999999996 12.121731996536255 18 10 C 17.999999999999996 7.878268003463745 17.157145619392395 5.84343683719635 15.656854629516602 4.343145847320557 C 14.156563639640808 2.842854857444763 12.121731996536255 2.000000000000001 10 2 Z M 9.989999771118164 8 C 10.547999799251556 8 11 8.452000200748444 11 9.010000228881836 L 11 14.134000778198242 C 11.190629214048386 14.244073517620564 11.339613139629364 14.413969710469246 11.423846244812012 14.617341995239258 C 11.50807934999466 14.82071428000927 11.522854901850224 15.046196192502975 11.46588134765625 15.258821487426758 C 11.408907793462276 15.47144678235054 11.283368244767189 15.659332856535912 11.108733177185059 15.793340682983398 C 10.934098109602928 15.927348509430885 10.72012610733509 15.999990315246578 10.5 16 L 10.010000228881836 16 C 9.87736514210701 16 9.74602822214365 15.973875842988491 9.623489379882812 15.923118591308594 C 9.500950537621975 15.872361339628696 9.389609314501286 15.79796502739191 9.295822143554688 15.704177856445312 C 9.20203497260809 15.610390685498714 9.127638660371304 15.499049462378025 9.076881408691406 15.376510620117188 C 9.026124157011509 15.25397177785635 9 15.12263485789299 9 14.989999771118164 L 9 10 C 8.734783500432968 10 8.480429783463478 9.89464296400547 8.292893409729004 9.707106590270996 C 8.10535703599453 9.519570216536522 8 9.265216499567032 8 9 C 8 8.734783500432968 8.10535703599453 8.480429783463478 8.292893409729004 8.292893409729004 C 8.480429783463478 8.10535703599453 8.734783500432968 8 9 8 L 9.989999771118164 8 Z M 10 5 C 10.265216499567032 5 10.519570216536522 5.10535703599453 10.707106590270996 5.292893409729004 C 10.89464296400547 5.480429783463478 11 5.734783500432968 11 6 C 11 6.265216499567032 10.89464296400547 6.519570216536522 10.707106590270996 6.707106590270996 C 10.519570216536522 6.89464296400547 10.265216499567032 7 10 7 C 9.734783500432968 7 9.480429783463478 6.89464296400547 9.292893409729004 6.707106590270996 C 9.10535703599453 6.519570216536522 9 6.265216499567032 9 6 C 9 5.734783500432968 9.10535703599453 5.480429783463478 9.292893409729004 5.292893409729004 C 9.480429783463478 5.10535703599453 9.734783500432968 4.999999999999999 10 5 Z"
                            Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}"
                            Stretch="Fill" />
                        <TextBlock
                            Margin="10,0,0,0"
                            VerticalAlignment="Center"
                            FontSize="{StaticResource LargeFontSize}"
                            FontWeight="DemiBold"
                            Text="About" />
                    </StackPanel>
                </Button>



                <!--  logo at the bottom  -->
                <StackPanel VerticalAlignment="Center">
                    <Image
                        Height="337"
                        Margin="-100,360,0,0"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Top"
                        ClipToBounds="False"
                        Opacity="0.08"
                        Source="/Assets/LogoImageBackground.png" />
                </StackPanel>
            </StackPanel>
        </Grid>

        <!--  content area on right side  -->

        <Grid x:Name="MainContentGrid" Grid.Column="1">
            <ScrollViewer HorizontalScrollBarVisibility="Disabled">
                <ScrollViewer.Style>
                    <Style TargetType="ScrollViewer">
                        <Setter Property="VerticalScrollBarVisibility" Value="Disabled" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ActualHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Converter={StaticResource ScrollBarVisibilityConverter}}" Value="True">
                                <Setter Property="VerticalScrollBarVisibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ScrollViewer.Style>
                <Grid>
                    <Grid.RowDefinitions>

                        <RowDefinition Height="2*" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <!--  <RowDefinition Height="39*"/>
                              <RowDefinition Height="18*" MaxHeight="194"/>
                              <RowDefinition Height="5*" MaxHeight="50"/>
                              <RowDefinition Height="30*"/> />-->
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="1.2*" />
                    </Grid.ColumnDefinitions>

                    <!--  Add targets area  -->
                    <Grid
                        Grid.Row="0"
                        Grid.Column="0"
                        MinHeight="50"
                        Margin="20,10,20,20">
                        <Border
                            x:Name="AddTargetsBorder"
                            HorizontalAlignment="Stretch"
                            Background="{StaticResource Light_Blue_Brush}"
                            CornerRadius="10">
                            <StackPanel x:Name="AddTargetsStackPanel" Margin="20">
                                <TextBlock
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="{StaticResource Text_Brush}"
                                    Style="{StaticResource LargeHeaderTextBlockStyle}"
                                    Text="Add targets" />
                                <Rectangle
                                    Height="2"
                                    Margin="0,10,0,0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Top"
                                    Stroke="{StaticResource Dark_Grey_Brush}"
                                    StrokeThickness="1" />

                                <!--  customized textbox  -->
                                <TextBox
                                    Height="50"
                                    Margin="0,20,0,10"
                                    Padding="10"
                                    VerticalContentAlignment="Center"
                                    FontSize="{StaticResource SmallFontSize}"
                                    Foreground="{StaticResource Dark_Grey_Brush}"
                                    Text="{Binding TargetToAdd}">
                                    <TextBox.Style>
                                        <Style xmlns:sys="clr-namespace:System;assembly=mscorlib" TargetType="TextBox">
                                            <Style.Resources>
                                                <VisualBrush
                                                    x:Key="TextBoxHintBrush"
                                                    AlignmentX="Left"
                                                    AlignmentY="Center"
                                                    Stretch="None">
                                                    <VisualBrush.Visual>
                                                        <Label
                                                            Content="   Enter a new target"
                                                            FontSize="{StaticResource SmallFontSize}"
                                                            Foreground="{StaticResource Dark_Grey_Brush}" />
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Style.Resources>
                                            <Style.Triggers>
                                                <Trigger Property="Text" Value="{x:Static sys:String.Empty}">
                                                    <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                </Trigger>
                                                <Trigger Property="Text" Value="{x:Null}">
                                                    <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                </Trigger>
                                                <Trigger Property="IsKeyboardFocused" Value="True">
                                                    <Setter Property="Background" Value="White" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                    <TextBox.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius" Value="5" />
                                        </Style>
                                    </TextBox.Resources>
                                </TextBox>

                                <StackPanel HorizontalAlignment="Left" Orientation="Vertical">
                                    <Button
                                        Width="94"
                                        Height="43"
                                        Margin="0,0,0,0"
                                        HorizontalAlignment="Left"
                                        Background="{StaticResource Dark_Blue_Brush}"
                                        Command="{Binding AddTargetCommand}"
                                        Template="{StaticResource ImageButtonTemplate}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image
                                                Width="18"
                                                Height="18"
                                                Source="{StaticResource addButtonIconDrawingImage}" />
                                            <TextBlock
                                                Margin="10,0,0,0"
                                                VerticalAlignment="Center"
                                                FontSize="{StaticResource SmallFontSize}"
                                                FontWeight="DemiBold"
                                                Foreground="{StaticResource White_Brush}"
                                                Text="Add" />
                                        </StackPanel>
                                    </Button>
                                    <TextBlock
                                        Margin="0,10,0,10"
                                        FontSize="{StaticResource SmallFontSize}"
                                        Foreground="{StaticResource Dark_Grey_Brush}"
                                        Text="Or" />


                                    <!--  Drag and Drop File Button  -->
                                    <Button
                                        x:Name="DragAndDropTargetsFileButton"
                                        MinWidth="150"
                                        MinHeight="50"
                                        MaxWidth="500"
                                        MaxHeight="250"
                                        Margin="0,0,0,0"
                                        AllowDrop="True"
                                        Background="{StaticResource White_Brush}"
                                        Click="DragAndDropTargetsFileButton_Click"
                                        Drop="DragAndDropTargetsFileButton_Drop"
                                        Template="{StaticResource DragAndDropButtonTemplate}">
                                        <StackPanel
                                            Margin="10"
                                            HorizontalAlignment="Center"
                                            Orientation="Vertical">
                                            <Image
                                                Width="25"
                                                Height="25"
                                                Source="{StaticResource dragDropButtonIconDrawingImage}" />
                                            <TextBlock
                                                Margin="10,5,0,0"
                                                VerticalAlignment="Center"
                                                FontSize="{StaticResource SmallFontSize}"
                                                FontWeight="DemiBold"
                                                Foreground="{StaticResource Text_Brush}"
                                                Text="Import From File"
                                                TextAlignment="Center"
                                                TextWrapping="Wrap" />
                                            <TextBlock
                                                Margin="10,0,0,0"
                                                VerticalAlignment="Center"
                                                FontSize="{StaticResource TinyFontSize}"
                                                Foreground="{StaticResource Dark_Grey_Brush}"
                                                Text="Drag And Drop Files Here"
                                                TextAlignment="Center" />
                                        </StackPanel>
                                    </Button>
                                    <TextBlock
                                        Margin="0,10,0,10"
                                        FontSize="{StaticResource VerySmallFontSize}"
                                        Foreground="{StaticResource Dark_Grey_Brush}"
                                        Text="*One URI Per Line" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>


                    <!--  Targets Area  -->
                    <Grid
                        Grid.Row="0"
                        Grid.Column="1"
                        Margin="0,10,20,20">
                        <Border
                            x:Name="TargetsBorder"
                            Background="{StaticResource Light_Blue_Brush}"
                            CornerRadius="10">
                            <Grid x:Name="TargetsGrid" Margin="20">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock
                                    Grid.Row="0"
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="{StaticResource Text_Brush}"
                                    Style="{StaticResource LargeHeaderTextBlockStyle}"
                                    Text="{Binding TargetsLabel}" />
                                <Rectangle
                                    Grid.Row="1"
                                    Height="2"
                                    Margin="0,10,0,20"
                                    HorizontalAlignment="Stretch"
                                    Stroke="{StaticResource Dark_Grey_Brush}"
                                    StrokeThickness="1" />

                                <Grid x:Name="TargetsListBoxGrid" Grid.Row="2">
                                    <ListBox
                                        AlternationCount="2"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        ItemsSource="{Binding Targets}"
                                        ScrollViewer.VerticalScrollBarVisibility="Visible">
                                        <ListBox.Style>
                                            <Style BasedOn="{StaticResource EmptyListStyle}" TargetType="ListBox">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ActualHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Converter={StaticResource ScrollBarVisibilityConverter}}" Value="True">
                                                        <Setter Property="MaxHeight" Value="250" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ListBox.Style>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Height="38">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock
                                                        Grid.Column="0"
                                                        Margin="5,0,0,0"
                                                        HorizontalAlignment="Left"
                                                        VerticalAlignment="Center"
                                                        FontSize="{StaticResource MediumFontSize}"
                                                        Foreground="{StaticResource Dark_Grey_Brush}"
                                                        MouseDown="TextBlock_MouseDown"
                                                        Text="{Binding .}" />
                                                    <Button
                                                        Grid.Column="1"
                                                        Margin="0,0,5,0"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Center"
                                                        Background="Transparent"
                                                        BorderThickness="0"
                                                        Click="TargetListViewItemDeleteButton_Click"
                                                        Foreground="Red">
                                                        <Image
                                                            Width="15"
                                                            Height="18"
                                                            Source="{StaticResource recycleBinIconDrawingImage}" />
                                                    </Button>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>


                    <!--  Select Verbosity Level Area  -->
                    <Grid
                        Grid.Row="1"
                        Grid.Column="0"
                        Margin="20,0,20,20">
                        <Border Background="{StaticResource Light_Blue_Brush}" CornerRadius="10">
                            <StackPanel x:Name="SelectVerbosityStackPanel" Margin="20">
                                <TextBlock
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="{StaticResource Text_Brush}"
                                    Style="{StaticResource LargeHeaderTextBlockStyle}"
                                    Text="Select verbosity level" />
                                <Rectangle
                                    Height="2"
                                    Margin="0,10,0,0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Top"
                                    Stroke="{StaticResource Dark_Grey_Brush}"
                                    StrokeThickness="1" />


                                <!--  custom radio button style / triggers embedded in stackpanel resources  -->
                                <ScrollViewer
                                    Padding="0,0,0,2"
                                    HorizontalScrollBarVisibility="Auto"
                                    VerticalScrollBarVisibility="Disabled">
                                    <ScrollViewer.Resources>
                                        <system:Double x:Key="{x:Static SystemParameters.HorizontalScrollBarHeightKey}">10</system:Double>
                                    </ScrollViewer.Resources>
                                    <StackPanel Margin="0,10,0,0" Orientation="Horizontal">
                                        <StackPanel.Resources>
                                            <Style x:Key="VerbosityRadioButtonStyle" TargetType="RadioButton">
                                                <Style.Triggers>
                                                    <Trigger Property="IsChecked" Value="False">
                                                        <Setter Property="BorderThickness" Value="0" />
                                                        <Setter Property="BorderBrush" Value="Black" />
                                                    </Trigger>
                                                </Style.Triggers>

                                                <Setter Property="BorderThickness" Value="1" />

                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="RadioButton">
                                                            <Border
                                                                x:Name="border"
                                                                Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="10">
                                                                <ContentPresenter
                                                                    Margin="0,0,0,0"
                                                                    HorizontalAlignment="Center"
                                                                    VerticalAlignment="Center" />
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                                                                    <Setter Property="Cursor" Value="Hand" />
                                                                </Trigger>
                                                                <Trigger Property="IsPressed" Value="True">
                                                                    <Setter TargetName="border" Property="Background" Value="LightBlue" />
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </StackPanel.Resources>
                                        <!--  verbosity levels as radiobuttons  -->
                                        <RadioButton
                                            x:Name="NormalVerbosityRadioButton"
                                            Width="106"
                                            Height="80"
                                            Margin="0,0,0,0"
                                            HorizontalAlignment="Left"
                                            Background="{StaticResource NormalVerbosity_Brush}"
                                            BorderBrush="Black"
                                            Command="{Binding NormalVerbosityCommand}"
                                            IsChecked="True"
                                            Style="{StaticResource VerbosityRadioButtonStyle}">
                                            <StackPanel Orientation="Vertical">
                                                <Image
                                                    Width="25"
                                                    Height="25"
                                                    Source="{StaticResource normalDrawingImage}" />
                                                <TextBlock
                                                    Margin="0,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="{StaticResource SmallFontSize}"
                                                    FontWeight="DemiBold"
                                                    Foreground="{StaticResource NormalVerbosityText_Brush}"
                                                    Text="Normal" />
                                            </StackPanel>
                                        </RadioButton>

                                        <RadioButton
                                            x:Name="DebugVerbosityRadioButton"
                                            Width="106"
                                            Height="80"
                                            Margin="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            Background="{StaticResource DebugVerbosity_Brush}"
                                            BorderBrush="Black"
                                            Command="{Binding VerboseVerbosityCommand}"
                                            Style="{StaticResource VerbosityRadioButtonStyle}">
                                            <StackPanel Orientation="Vertical">
                                                <Image
                                                    Width="25"
                                                    Height="25"
                                                    Source="{StaticResource debugDrawingImage}" />
                                                <TextBlock
                                                    Margin="0,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="{StaticResource SmallFontSize}"
                                                    FontWeight="DemiBold"
                                                    Foreground="{StaticResource DebugVerbosityText_Brush}"
                                                    Text="Debug" />
                                            </StackPanel>
                                        </RadioButton>

                                        <RadioButton
                                            x:Name="TraceVerbosityRadioButton"
                                            Width="106"
                                            Height="80"
                                            Margin="5,0,0,0"
                                            HorizontalAlignment="Left"
                                            Background="{StaticResource TraceVerbosity_Brush}"
                                            BorderBrush="Black"
                                            Command="{Binding TraceVerbosityCommand}"
                                            Style="{StaticResource VerbosityRadioButtonStyle}">
                                            <StackPanel Orientation="Vertical">
                                                <Image
                                                    Width="25"
                                                    Height="25"
                                                    Source="{StaticResource traceDrawingImage}" />
                                                <TextBlock
                                                    Margin="0,0,0,0"
                                                    VerticalAlignment="Center"
                                                    FontSize="{StaticResource SmallFontSize}"
                                                    FontWeight="DemiBold"
                                                    Foreground="{StaticResource TraceVerbosityText_Brush}"
                                                    Text="Trace" />
                                            </StackPanel>
                                        </RadioButton>
                                    </StackPanel>
                                </ScrollViewer>
                            </StackPanel>
                        </Border>
                    </Grid>


                    <!--  Output Report File Location Area  -->
                    <Grid
                        Grid.Row="1"
                        Grid.Column="1"
                        Margin="0,0,20,20">
                        <Border Background="{StaticResource Light_Blue_Brush}" CornerRadius="10">
                            <StackPanel
                                x:Name="OutputReportStackPanel"
                                Margin="20"
                                Orientation="Vertical">
                                <TextBlock
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="{StaticResource Text_Brush}"
                                    Style="{StaticResource LargeHeaderTextBlockStyle}"
                                    Text="Select the output report location" />
                                <Rectangle
                                    Height="2"
                                    Margin="0,10,0,0"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Top"
                                    Stroke="{StaticResource Dark_Grey_Brush}"
                                    StrokeThickness="1" />

                                <Grid Margin="0,40,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!--  customized textbox  -->
                                    <TextBox
                                        x:Name="outputReportFileTextBox"
                                        Grid.Column="0"
                                        Height="50"
                                        Margin="0,0,5,0"
                                        Padding="10"
                                        HorizontalAlignment="Stretch"
                                        VerticalContentAlignment="Center"
                                        FontSize="{StaticResource SmallFontSize}"
                                        FontWeight="DemiBold"
                                        Foreground="{StaticResource Text_Brush}"
                                        Text="{Binding OutputFileLocation}">
                                        <TextBox.Style>
                                            <Style xmlns:sys="clr-namespace:System;assembly=mscorlib" TargetType="TextBox">
                                                <Style.Resources>
                                                    <VisualBrush
                                                        x:Key="TextBoxHintBrush"
                                                        AlignmentX="Left"
                                                        AlignmentY="Center"
                                                        Stretch="None">
                                                        <VisualBrush.Visual>
                                                            <Label
                                                                Content="   Paste location here or browse files"
                                                                FontSize="{StaticResource SmallFontSize}"
                                                                Foreground="{StaticResource Dark_Grey_Brush}" />
                                                        </VisualBrush.Visual>
                                                    </VisualBrush>
                                                </Style.Resources>
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="{x:Static sys:String.Empty}">
                                                        <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="Text" Value="{x:Null}">
                                                        <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="IsKeyboardFocused" Value="True">
                                                        <Setter Property="Background" Value="White" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBox.Style>
                                        <TextBox.ToolTip>
                                            <ToolTip>
                                                <DockPanel>
                                                    <TextBlock>Omit filename for automatic naming.</TextBlock>
                                                </DockPanel>
                                            </ToolTip>
                                        </TextBox.ToolTip>
                                        <TextBox.Resources>
                                            <Style TargetType="{x:Type Border}">
                                                <Setter Property="CornerRadius" Value="5" />
                                            </Style>
                                        </TextBox.Resources>
                                    </TextBox>

                                    <!--  Browse Button  -->
                                    <Button
                                        x:Name="browseOutputReportFileButton"
                                        Grid.Column="1"
                                        Height="50"
                                        Margin="0,0,0,0"
                                        Padding="5,0,5,0"
                                        HorizontalAlignment="Stretch"
                                        Background="{StaticResource Blue_Button_Brush}"
                                        Click="BrowseOutputReportFileButton_Click"
                                        Opacity="1"
                                        Template="{StaticResource ImageButtonTemplate}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image
                                                Width="20"
                                                Height="20"
                                                Source="{StaticResource browseButtonIconDrawingImage}" />
                                            <TextBlock
                                                Margin="10,0,0,0"
                                                VerticalAlignment="Center"
                                                FontSize="{StaticResource SmallFontSize}"
                                                FontWeight="DemiBold"
                                                Foreground="{StaticResource Dark_Blue_Brush}"
                                                Text="Browse" />
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!--  Start Stop OpenReport Button Area  -->
                    <Grid
                        Grid.Row="2"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        Height="50"
                        Margin="20,0,20,0">
                        <StackPanel Orientation="Horizontal">
                            <Button
                                x:Name="StartButton"
                                Width="94"
                                Height="40"
                                Margin="0,0,7,0"
                                HorizontalAlignment="Left"
                                Background="{StaticResource Green_Button_Brush}"
                                Command="{Binding ScanCommand}"
                                Style="{StaticResource GrayDisabledButton}"
                                Template="{StaticResource ImageButtonTemplate}">
                                <StackPanel Orientation="Horizontal">
                                    <Image
                                        Width="15"
                                        Height="15"
                                        Source="{StaticResource startButtonIconDrawingImage}" />
                                    <TextBlock
                                        Margin="10,0,0,0"
                                        VerticalAlignment="Center"
                                        FontSize="{StaticResource SmallFontSize}"
                                        FontWeight="DemiBold"
                                        Foreground="{StaticResource White_Brush}"
                                        Text="Scan" />
                                </StackPanel>
                            </Button>

                            <Button
                                x:Name="StopButton"
                                Width="97"
                                Height="40"
                                Margin="0,0,7,0"
                                HorizontalAlignment="Left"
                                Background="{StaticResource Red_Button_Brush}"
                                Command="{Binding ScanCancelCommand}"
                                Style="{StaticResource GrayDisabledButton}"
                                Template="{StaticResource ImageButtonTemplate}">
                                <StackPanel Orientation="Horizontal">
                                    <Path
                                        Width="15"
                                        Height="15"
                                        Data="F1 M 0 15 L 0 0 L 15 0 L 15 15 L 0 15 Z M 2 13 L 13 13 L 13 2 L 2 2 L 2 13 Z"
                                        Fill="{StaticResource Light_Blue_Brush}"
                                        Stretch="Fill" />
                                    <TextBlock
                                        Margin="10,0,0,0"
                                        VerticalAlignment="Center"
                                        FontSize="{StaticResource SmallFontSize}"
                                        FontWeight="DemiBold"
                                        Foreground="{StaticResource White_Brush}"
                                        Text="Cancel" />
                                </StackPanel>
                            </Button>

                            <Button
                                x:Name="OpenReportButton"
                                Width="236"
                                Height="40"
                                Margin="0,0,7,0"
                                HorizontalAlignment="Left"
                                Background="{StaticResource Light_Blue_Button_Brush}"
                                Command="{Binding OpenReportCommand}"
                                Style="{StaticResource GrayDisabledButton}"
                                Template="{StaticResource ImageButtonTemplate}">
                                <StackPanel Orientation="Horizontal">
                                    <Image
                                        Width="25"
                                        Height="25"
                                        Source="{StaticResource openReportButtonIconDrawingImage}" />
                                    <TextBlock
                                        Margin="10,0,0,0"
                                        VerticalAlignment="Center"
                                        FontSize="{StaticResource SmallFontSize}"
                                        FontWeight="DemiBold"
                                        Foreground="{StaticResource White_Brush}"
                                        Text="Open Report" />
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>


                    <!--  Log Messages Area  -->
                    <Grid
                        Grid.Row="3"
                        Grid.Column="0"
                        Grid.ColumnSpan="2"
                        MinHeight="100"
                        Margin="20,0,20,20">
                        <Border
                            x:Name="LogMessagesBorder"
                            Background="{StaticResource Light_Blue_Brush}"
                            CornerRadius="10">
                            <Grid Margin="20">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock
                                    Grid.Row="0"
                                    Margin="0,0,0,20"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    Foreground="{StaticResource Text_Brush}"
                                    Style="{StaticResource LargeHeaderTextBlockStyle}"
                                    Text="Log messages" />

                                <Border
                                    x:Name="borderborder"
                                    Grid.Row="1"
                                    BorderBrush="{StaticResource Dark_Grey_Brush}"
                                    BorderThickness="0.5">
                                    <TextBox
                                        Background="White"
                                        BorderThickness="0"
                                        IsReadOnly="True"
                                        Text="{Binding Log, Mode=OneWay}"
                                        TextWrapping="Wrap"
                                        VerticalScrollBarVisibility="Visible">
                                        <TextBox.Style>
                                            <Style TargetType="TextBox">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ActualHeight, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Converter={StaticResource ScrollBarVisibilityConverter}}" Value="True">
                                                        <Setter Property="MaxHeight" Value="200" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>
            </ScrollViewer>
        </Grid>

    </Grid>
</Window>
