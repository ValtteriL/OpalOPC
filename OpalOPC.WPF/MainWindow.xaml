<Window x:Class="OpalOPC.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:OpalOPC.WPF" 
        d:DataContext="{d:DesignInstance Type=local:MainWindowViewModel}"
        mc:Ignorable="d" 
        Title="{Binding Title}" Height="800" Width="600"
        Background="{StaticResource White_Brush}"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        UseLayoutRounding="True"
        MinWidth="1145">

    <Window.Resources>

        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
            <Style.Triggers>
                <Trigger Property="ItemsControl.AlternationIndex" Value="0">
                    <Setter Property="Background" Value="{StaticResource ListItem_Background_Brush}"></Setter>
                </Trigger>
                <Trigger Property="ItemsControl.AlternationIndex" Value="1">
                    <Setter Property="Background" Value="Transparent"></Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="EmptyListStyle"
           TargetType="ListBox"
           BasedOn="{StaticResource {x:Type ListBox}}">
            <Style.Triggers>
                <Trigger Property="HasItems" Value="False">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <TextBlock>No targets specified.</TextBlock>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>


        <Style TargetType="Button" x:Key="NavbarCustomButtonTemplateStyle">
            <Setter Property="Foreground" Value="{StaticResource Dark_Grey_Brush}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" BorderBrush="Black" BorderThickness="0" CornerRadius="10">
                            <ContentPresenter x:Name="contentPresenter" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="60,0,0,0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                                <Setter Property="Foreground" Value="{StaticResource Dark_Blue_Brush}"/>
                                <Setter Property="Cursor" Value="Hand" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="LightBlue" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        

        <ControlTemplate x:Key="ImageButtonTemplate" TargetType="Button">
            <Border x:Name="border" BorderBrush="Black" BorderThickness="0" CornerRadius="5" Background="{TemplateBinding Background}">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0"/>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                    <Setter Property="Cursor" Value="Hand" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="border" Property="Background" Value="LightBlue" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>


        <ControlTemplate x:Key="DragAndDropButtonTemplate" TargetType="Button">
            <Border x:Name="border" BorderThickness="1,1,1,1" CornerRadius="10" Background="{TemplateBinding Background}">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0"/>
                <Border.BorderBrush>
                    <DrawingBrush Viewport="0,0,16,16" ViewportUnits="Absolute" TileMode="Tile">
                        <DrawingBrush.Drawing>
                            <DrawingGroup>
                                <GeometryDrawing Brush="Black">
                                    <GeometryDrawing.Geometry>
                                        <GeometryGroup>
                                            <RectangleGeometry Rect="0,0,50,50" />
                                            <RectangleGeometry Rect="50,50,50,50" />
                                        </GeometryGroup>
                                    </GeometryDrawing.Geometry>
                                </GeometryDrawing>
                            </DrawingGroup>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Border.BorderBrush>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                    <Setter Property="Cursor" Value="Hand" />
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter TargetName="border" Property="Background" Value="LightBlue" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>


    </Window.Resources>


    <Grid MinWidth="1100" x:Name="TopLevelWindowGrid" ScrollViewer.VerticalScrollBarVisibility="Disabled">
        <Grid.ColumnDefinitions>
            <!-- navigation bar left -->
            <ColumnDefinition Width="18*"/>

            <!-- content area right -->
            <ColumnDefinition Width="82*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition />
        </Grid.RowDefinitions>

        <!-- navbar on left side -->
        <Grid Grid.Column="0" Grid.Row="0" >
            <StackPanel Background="{StaticResource NavBarBackground_Brush}">
            <StackPanel VerticalAlignment="Center" Margin="0,40,0,60">
                <Image Source="/Assets/LogoImage.png"  Stretch="Uniform" VerticalAlignment="Center" HorizontalAlignment="Center" Width="Auto" Height="50" RenderOptions.BitmapScalingMode="HighQuality" />
            </StackPanel>

            <!--Navbar buttons-->
                <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" >

                    <Button Margin="10,0,10,10" Width="Auto" Height="62" Style="{StaticResource NavbarCustomButtonTemplateStyle}" Click="Navbar_About_Click">
                    <StackPanel Orientation="Horizontal">
                        <Path Data="F1 M 10 0 C 15.52299976348877 0 20 4.4770002365112305 20 10 C 20 15.52299976348877 15.52299976348877 20 10 20 C 4.4770002365112305 20 0 15.52299976348877 0 10 C 0 4.4770002365112305 4.4770002365112305 0 10 0 Z M 10 2 C 7.878268003463745 2.0000000000000018 5.84343683719635 2.842854857444763 4.343145847320557 4.343145847320557 C 2.842854857444763 5.84343683719635 2.0000000000000027 7.878268003463745 2 10 C 2.0000000000000018 12.121731996536255 2.842854857444763 14.156563639640808 4.343145847320557 15.656854629516602 C 5.84343683719635 17.157145619392395 7.878268003463745 17.999999999999996 10 18 C 12.121731996536255 17.999999999999996 14.156563639640808 17.157145619392395 15.656854629516602 15.656854629516602 C 17.157145619392395 14.156563639640808 17.999999999999996 12.121731996536255 18 10 C 17.999999999999996 7.878268003463745 17.157145619392395 5.84343683719635 15.656854629516602 4.343145847320557 C 14.156563639640808 2.842854857444763 12.121731996536255 2.000000000000001 10 2 Z M 9.989999771118164 8 C 10.547999799251556 8 11 8.452000200748444 11 9.010000228881836 L 11 14.134000778198242 C 11.190629214048386 14.244073517620564 11.339613139629364 14.413969710469246 11.423846244812012 14.617341995239258 C 11.50807934999466 14.82071428000927 11.522854901850224 15.046196192502975 11.46588134765625 15.258821487426758 C 11.408907793462276 15.47144678235054 11.283368244767189 15.659332856535912 11.108733177185059 15.793340682983398 C 10.934098109602928 15.927348509430885 10.72012610733509 15.999990315246578 10.5 16 L 10.010000228881836 16 C 9.87736514210701 16 9.74602822214365 15.973875842988491 9.623489379882812 15.923118591308594 C 9.500950537621975 15.872361339628696 9.389609314501286 15.79796502739191 9.295822143554688 15.704177856445312 C 9.20203497260809 15.610390685498714 9.127638660371304 15.499049462378025 9.076881408691406 15.376510620117188 C 9.026124157011509 15.25397177785635 9 15.12263485789299 9 14.989999771118164 L 9 10 C 8.734783500432968 10 8.480429783463478 9.89464296400547 8.292893409729004 9.707106590270996 C 8.10535703599453 9.519570216536522 8 9.265216499567032 8 9 C 8 8.734783500432968 8.10535703599453 8.480429783463478 8.292893409729004 8.292893409729004 C 8.480429783463478 8.10535703599453 8.734783500432968 8 9 8 L 9.989999771118164 8 Z M 10 5 C 10.265216499567032 5 10.519570216536522 5.10535703599453 10.707106590270996 5.292893409729004 C 10.89464296400547 5.480429783463478 11 5.734783500432968 11 6 C 11 6.265216499567032 10.89464296400547 6.519570216536522 10.707106590270996 6.707106590270996 C 10.519570216536522 6.89464296400547 10.265216499567032 7 10 7 C 9.734783500432968 7 9.480429783463478 6.89464296400547 9.292893409729004 6.707106590270996 C 9.10535703599453 6.519570216536522 9 6.265216499567032 9 6 C 9 5.734783500432968 9.10535703599453 5.480429783463478 9.292893409729004 5.292893409729004 C 9.480429783463478 5.10535703599453 9.734783500432968 4.999999999999999 10 5 Z" 
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}" Width="24" Height="24" Stretch="Fill" />
                        <TextBlock Text="About" Margin="10,0,0,0" FontSize="{StaticResource LargeFontSize}" FontWeight="DemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

            </StackPanel>

            <!--logo at the bottom-->
            <StackPanel VerticalAlignment="Center">
                <Image ClipToBounds="False" Source="/Assets/LogoImageBackground.png" Opacity="0.08" Margin="-100,360,0,0" VerticalAlignment="Top" HorizontalAlignment="Stretch" Height="337" />
            </StackPanel>
        </StackPanel>
        </Grid>

        <!-- content area on right side -->
        <ScrollViewer Grid.Column="1" Height="{Binding ActualHeight, ElementName=TopLevelWindowGrid}" >
            <Grid x:Name="MainContentGrid" >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="39*"/>
                        <RowDefinition Height="18*" MaxHeight="194"/>
                        <RowDefinition Height="5*" MaxHeight="50"/>
                        <RowDefinition Height="30*"/>
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="44*"/>
                        <ColumnDefinition Width="56*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Add targets area -->
                    <Grid Grid.Row="0" Grid.Column="0" MinHeight="50" Margin="20,10,20,20" >
                        <Border x:Name="AddTargetsBorder" Background="{StaticResource Light_Blue_Brush}" CornerRadius="10" HorizontalAlignment="Stretch">
                            <StackPanel x:Name="AddTargetsStackPanel" Margin="20">
                                <TextBlock Text="Add targets" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Foreground="{StaticResource Text_Brush}" Style="{StaticResource LargeHeaderTextBlockStyle}" />
                                <Line X2="{Binding ActualWidth, ElementName=AddTargetsStackPanel}" Stroke="{StaticResource Dark_Grey_Brush}" StrokeThickness="1" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Stretch" />

                                <!--customized textbox-->
                                <TextBox Text="{Binding TargetToAdd}" Padding="10" Margin="0,20,0,10" Height="50" VerticalContentAlignment="Center" Foreground="{StaticResource Dark_Grey_Brush}" FontSize="{StaticResource SmallFontSize}">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox" xmlns:sys="clr-namespace:System;assembly=mscorlib">
                                            <Style.Resources>
                                                <VisualBrush x:Key="TextBoxHintBrush" AlignmentX="Left" AlignmentY="Center" Stretch="None">
                                                    <VisualBrush.Visual>
                                                        <Label Content="   Enter a new target" Foreground="{StaticResource Dark_Grey_Brush}" FontSize="{StaticResource SmallFontSize}" />
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Style.Resources>
                                            <Style.Triggers>
                                                <Trigger Property="Text" Value="{x:Static sys:String.Empty}">
                                                    <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                </Trigger>
                                                <Trigger Property="Text" Value="{x:Null}">
                                                    <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                </Trigger>
                                                <Trigger Property="IsKeyboardFocused" Value="True">
                                                    <Setter Property="Background" Value="White" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                    <TextBox.Resources>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius" Value="5"/>
                                        </Style>
                                    </TextBox.Resources>
                                </TextBox>

                                <StackPanel Orientation="Vertical" HorizontalAlignment="Left">
                                    <Button HorizontalAlignment="Left" Margin="0,0,0,0" Width="94" Height="43" Template="{StaticResource ImageButtonTemplate}" Background="{StaticResource Dark_Blue_Brush}" Command="{Binding AddTargetCommand}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{StaticResource addButtonIconDrawingImage}" Width="18" Height="18"/>
                                            <TextBlock Text="Add" Margin="10,0,0,0" Foreground="{StaticResource White_Brush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center" FontWeight="DemiBold"/>
                                        </StackPanel>
                                    </Button>
                                    <TextBlock Margin="0,10,0,10" Text="Or" FontSize="{StaticResource SmallFontSize}" Foreground="{StaticResource Dark_Grey_Brush}"/>


                                    <!--Drag and Drop File Button-->
                                    <Button x:Name="DragAndDropTargetsFileButton" Margin="0,0,0,0" MinWidth="201" MinHeight="50" MaxHeight="250" MaxWidth="500" Template="{StaticResource DragAndDropButtonTemplate}" Background="{StaticResource White_Brush}"
                                        AllowDrop="True"
                                        Drop="DragAndDropTargetsFileButton_Drop"
                                        Click="DragAndDropTargetsFileButton_Click">
                                        <StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="10">
                                            <Image Source="{StaticResource dragDropButtonIconDrawingImage}" Width="25" Height="25"/>
                                            <TextBlock TextWrapping="Wrap" TextAlignment="Center" Text="Import From File" Margin="10,5,0,0" Foreground="{StaticResource Text_Brush}" FontWeight="DemiBold" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center"/>
                                            <TextBlock TextAlignment="Center" Text="Drag And Drop Files Here" Margin="10,0,0,0" Foreground="{StaticResource Dark_Grey_Brush}" FontSize="{StaticResource TinyFontSize}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                    <TextBlock Margin="0,10,0,10" Text="*One URI Per Line" FontSize="{StaticResource VerySmallFontSize}" Foreground="{StaticResource Dark_Grey_Brush}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>



                    <!--Targets Area-->
                    <Grid Grid.Row="0" Grid.Column="1" MinHeight="50" MaxHeight="{Binding ActualHeight, ElementName=AddTargetsBorder}" Margin="0,10,40,20">
                        <Border x:Name="TargetsBorder" Background="{StaticResource Light_Blue_Brush}"  CornerRadius="10"  >
                            <Grid x:Name="TargetsGrid" Margin="20" >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="{Binding TargetsLabel}" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Foreground="{StaticResource Text_Brush}" Style="{StaticResource LargeHeaderTextBlockStyle}" />
                                <Line Grid.Row="1" X2="{Binding ActualWidth, ElementName=TargetsGrid}" Stroke="{StaticResource Dark_Grey_Brush}" StrokeThickness="1" Margin="0,10,0,20" HorizontalAlignment="Stretch" />
                                <Grid Grid.Row="2" x:Name="TargetsListBoxGrid">
                                    <ListBox ScrollViewer.VerticalScrollBarVisibility="Visible" ItemsSource="{Binding Targets}" AlternationCount="2" Style="{StaticResource EmptyListStyle}" BorderThickness="0" Background="Transparent">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Height="38">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition/>
                                                        <ColumnDefinition/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0" Text="{Binding .}" MouseDown="TextBlock_MouseDown" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="5,0,0,0" Foreground="{StaticResource Dark_Grey_Brush}" FontSize="{StaticResource MediumFontSize}"/>
                                                    <Button Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,5,0" Background="Transparent" Foreground="Red" BorderThickness="0" Click="TargetListViewItemDeleteButton_Click" >
                                                        <Image Source="{StaticResource recycleBinIconDrawingImage}" Width="15" Height="18"/>
                                                    </Button>
                                                </Grid>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>

                    
                    <!--Select Verbosity Level Area-->
                    <Grid Grid.Row="1" Grid.Column="0" Margin="20,0,20,20">
                        <Border Background="{StaticResource Light_Blue_Brush}" CornerRadius="10" >
                            <StackPanel x:Name="SelectVerbosityStackPanel"  Margin="20">
                                <TextBlock Text="Select verbosity level" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Foreground="{StaticResource Text_Brush}" Style="{StaticResource LargeHeaderTextBlockStyle}" />
                                <Line X2="{Binding ActualWidth, ElementName=SelectVerbosityStackPanel}" Stroke="{StaticResource Dark_Grey_Brush}" StrokeThickness="1" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Stretch" />

                                <!--custom radio button style / triggers embedded in stackpanel resources-->
                                <StackPanel Margin="0,20,0,20" Orientation="Horizontal">
                                    <StackPanel.Resources>
                                        <Style x:Key="VerbosityRadioButtonStyle" TargetType="RadioButton">
                                            <Style.Triggers>
                                                <Trigger Property="IsChecked" Value="False">
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Setter Property="BorderBrush" Value="Black"/>
                                                </Trigger>
                                            </Style.Triggers>

                                            <Setter Property="BorderThickness" Value="1"/>

                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="RadioButton">
                                                        <Border x:Name="border" 
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            BorderBrush="{TemplateBinding BorderBrush}" 
                                                            CornerRadius="10" 
                                                            Background="{TemplateBinding Background}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,0,0,0"/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="{StaticResource NavBarButtonHover_Brush}" />
                                                                <Setter Property="Cursor" Value="Hand" />
                                                            </Trigger>
                                                            <Trigger Property="IsPressed" Value="True">
                                                                <Setter TargetName="border" Property="Background" Value="LightBlue" />
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </StackPanel.Resources>

                                    <!--verbosity levels as radiobuttons-->
                                    <RadioButton x:Name="NormalVerbosityRadioButton" Style="{StaticResource VerbosityRadioButtonStyle}" BorderBrush="Black" HorizontalAlignment="Left" Margin="0,0,0,0" Width="106" Height="80" Background="{StaticResource NormalVerbosity_Brush}" Command="{Binding NormalVerbosityCommand}" IsChecked="True">
                                        <StackPanel Orientation="Vertical">
                                            <Image Source="{StaticResource normalDrawingImage}" Width="25" Height="25"/>
                                            <TextBlock Text="Normal" Margin="0,0,0,0" Foreground="{StaticResource NormalVerbosityText_Brush}" FontSize="{StaticResource SmallFontSize}" FontWeight="DemiBold" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton x:Name="DebugVerbosityRadioButton" Style="{StaticResource VerbosityRadioButtonStyle}" BorderBrush="Black" HorizontalAlignment="Left" Margin="5,0,0,0" Width="106" Height="80" Background="{StaticResource DebugVerbosity_Brush}" Command="{Binding VerboseVerbosityCommand}">
                                        <StackPanel Orientation="Vertical">
                                            <Image Source="{StaticResource debugDrawingImage}" Width="25" Height="25"/>
                                            <TextBlock Text="Debug" Margin="0,0,0,0" Foreground="{StaticResource DebugVerbosityText_Brush}" FontSize="{StaticResource SmallFontSize}" FontWeight="DemiBold" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>

                                    <RadioButton x:Name="TraceVerbosityRadioButton" Style="{StaticResource VerbosityRadioButtonStyle}" BorderBrush="Black" HorizontalAlignment="Left" Margin="5,0,0,0" Width="106" Height="80" Background="{StaticResource TraceVerbosity_Brush}" Command="{Binding TraceVerbosityCommand}">
                                        <StackPanel Orientation="Vertical">
                                            <Image Source="{StaticResource traceDrawingImage}" Width="25" Height="25"/>
                                            <TextBlock Text="Trace" Margin="0,0,0,0" Foreground="{StaticResource TraceVerbosityText_Brush}" FontSize="{StaticResource SmallFontSize}" FontWeight="DemiBold" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </RadioButton>

                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>


                    <!--Output Report File Location Area -->
                    <Grid Grid.Row="1" Grid.Column="1" Margin="0,0,40,20">
                        <Border Background="{StaticResource Light_Blue_Brush}" CornerRadius="10" >
                            <StackPanel x:Name="OutputReportStackPanel"  Margin="20">
                                <TextBlock Text="Select the output report file location" Margin="0,0,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Foreground="{StaticResource Text_Brush}" Style="{StaticResource LargeHeaderTextBlockStyle}" />
                                <Line X2="{Binding ActualWidth, ElementName=OutputReportStackPanel}" Stroke="{StaticResource Dark_Grey_Brush}" StrokeThickness="1" Margin="0,10,0,0" VerticalAlignment="Top" HorizontalAlignment="Stretch" />

                                <Grid Margin="0,40,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2.6*"/>
                                        <ColumnDefinition Width="1*"/>
                                    </Grid.ColumnDefinitions>

                                    <!--customized textbox-->
                                    <TextBox Grid.Column="0" HorizontalAlignment="Stretch" x:Name="outputReportFileTextBox" Padding="10" Margin="0,0,5,0" Height="50" VerticalContentAlignment="Center" Foreground="{StaticResource Text_Brush}" FontWeight="DemiBold" FontSize="{StaticResource SmallFontSize}" Text="{Binding OutputFileLocation}">
                                        <TextBox.Style>
                                            <Style TargetType="TextBox" xmlns:sys="clr-namespace:System;assembly=mscorlib">
                                                <Style.Resources>
                                                    <VisualBrush x:Key="TextBoxHintBrush" AlignmentX="Left" AlignmentY="Center" Stretch="None">
                                                        <VisualBrush.Visual>
                                                            <Label Content="   Paste location here or browse files" Foreground="{StaticResource Dark_Grey_Brush}" FontSize="{StaticResource SmallFontSize}"/>
                                                        </VisualBrush.Visual>
                                                    </VisualBrush>
                                                </Style.Resources>
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="{x:Static sys:String.Empty}">
                                                        <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="Text" Value="{x:Null}">
                                                        <Setter Property="Background" Value="{StaticResource TextBoxHintBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="IsKeyboardFocused" Value="True">
                                                        <Setter Property="Background" Value="White" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBox.Style>
                                        <TextBox.ToolTip>
                                            <ToolTip>
                                                <DockPanel>
                                                    <TextBlock>Omit filename for automatic naming.</TextBlock>
                                                </DockPanel>
                                            </ToolTip>
                                        </TextBox.ToolTip>
                                        <TextBox.Resources>
                                            <Style TargetType="{x:Type Border}">
                                                <Setter Property="CornerRadius" Value="5"/>
                                            </Style>
                                        </TextBox.Resources>
                                    </TextBox>

                                    <!-- Browse Button-->
                                    <Button x:Name="browseOutputReportFileButton" Grid.Column="1" HorizontalAlignment="Right" Margin="0,0,7,0" Width="151" Height="50" Template="{StaticResource ImageButtonTemplate}" Click="BrowseOutputReportFileButton_Click" Background="{StaticResource Blue_Button_Brush}" Opacity="1">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{StaticResource browseButtonIconDrawingImage}" Width="20" Height="20"/>
                                            <TextBlock Text="Browse" Margin="10,0,0,0" Foreground="{StaticResource Dark_Blue_Brush}" FontSize="{StaticResource SmallFontSize}" FontWeight="DemiBold" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!--Start Stop OpenReport Button Area-->
                    <Grid Height="50" Margin="20,0,20,0" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2">
                        <StackPanel Orientation="Horizontal" >
                            <Button x:Name="StartButton" HorizontalAlignment="Left" Margin="0,0,7,0" Width="94" Height="40" Template="{StaticResource ImageButtonTemplate}" Command="{Binding ScanCommand}" Background="{StaticResource Green_Button_Brush}">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{StaticResource startButtonIconDrawingImage}" Width="15" Height="15"/>
                                    <TextBlock Text="Scan" Margin="10,0,0,0" Foreground="{StaticResource White_Brush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center" FontWeight="DemiBold"/>
                                </StackPanel>
                            </Button>

                            <Button x:Name="StopButton" HorizontalAlignment="Left" Margin="0,0,7,0" Width="97" Height="40" Template="{StaticResource ImageButtonTemplate}" Command="{Binding ScanCancelCommand}" Background="{StaticResource Red_Button_Brush}">
                                <StackPanel Orientation="Horizontal">
                                    <Path Data="F1 M 0 15 L 0 0 L 15 0 L 15 15 L 0 15 Z M 2 13 L 13 13 L 13 2 L 2 2 L 2 13 Z" 
                                          Fill="{StaticResource Light_Blue_Brush}" Width="15" Height="15" Stretch="Fill"/>
                                    <TextBlock Text="Cancel" Margin="10,0,0,0" Foreground="{StaticResource White_Brush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center" FontWeight="DemiBold"/>
                                </StackPanel>
                            </Button>

                            <Button x:Name="OpenReportButton" HorizontalAlignment="Left" Margin="0,0,7,0" Width="236" Height="40" Template="{StaticResource ImageButtonTemplate}" Command="{Binding OpenReportCommand}"  Background="{StaticResource Light_Blue_Button_Brush}">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="{StaticResource openReportButtonIconDrawingImage}" Width="25" Height="25"/>
                                    <TextBlock Text="Open Report" Margin="10,0,0,0" Foreground="{StaticResource White_Brush}" FontSize="{StaticResource SmallFontSize}" VerticalAlignment="Center" FontWeight="DemiBold"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>


                    <!--Log Messages Area -->
                    <Grid MinHeight="100" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="20,0,40,20">
                        <Border x:Name="LogMessagesBorder"  Background="{StaticResource Light_Blue_Brush}" CornerRadius="10" >
                            <Grid Margin="20">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="Log messages" Margin="0,0,0,20" VerticalAlignment="Top" HorizontalAlignment="Left" Foreground="{StaticResource Text_Brush}" Style="{StaticResource LargeHeaderTextBlockStyle}" />

                                <Border x:Name="borderborder" Grid.Row="1" BorderBrush="{StaticResource Dark_Grey_Brush}" BorderThickness="0.5">
                                    <TextBox Height="{Binding ActualHeight, ElementName=borderborder}"
                                             Text="{Binding Log, Mode=OneWay}"
                                             Background="White"
                                             BorderThickness="0"
                                             IsReadOnly="True"
                                             TextWrapping="Wrap" 
                                             VerticalScrollBarVisibility="Visible"/>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>
            </Grid>
        </ScrollViewer>
    </Grid>

</Window>
