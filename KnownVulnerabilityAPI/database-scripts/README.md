# Database scripts

Index CPE dictionary and CVE JSON feeds into SQLite
Allow searching for CVEs by a version string

Indexed database is ~2.8GB
Indexing takes ~20minutes (plus moving to repo)

Uses the following data:

- NIST CPE dictionary: [https://nvd.nist.gov/feeds/xml/cpe/dictionary/official-cpe-dictionary_v2.3.xml.gz](https://nvd.nist.gov/feeds/xml/cpe/dictionary/official-cpe-dictionary_v2.3.xml.gz)
- Legacy NVD CVE Data Feeds: [https://github.com/fkie-cad/nvd-json-data-feeds](https://github.com/fkie-cad/nvd-json-data-feeds)

## Getting started

### Install dependencies

```bash
sudo apt install perl-doc cpanminus libssl-dev build-essential libz-dev
sudo cpanm Carton
carton install
```

### Index data

These are meant to be run with Ansible, but here are the commands:

```bash
carton exec perl index.pl <path_to_nvd_json_data_feeds_dir> <path_to_cpe_dictionary_file> <database_path>
```

### Query

```bash
carton exec perl query.pl cpe.db '<place query here>'
```
