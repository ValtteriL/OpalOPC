using KnownVulnerabilityAPI.Models;

namespace KnownVulnerabilityAPI.Services
{
    public interface INVDAPIService
    {
        public Task<CVEResult?> QueryCVE(string cpe);
    }
    public class NVDAPIService(IHttpClientFactory httpClientFactory) : INVDAPIService
    {

        private readonly HttpClient _client = httpClientFactory.CreateClient();
        private readonly string _cveBaseUri = "https://services.nvd.nist.gov/rest/json/cves/2.0";

        public async Task<CVEResult?> QueryCVE(string cpe) => await _client.GetFromJsonAsync<CVEResult>($"{_cveBaseUri}?cpeName={cpe}");
    }
}
